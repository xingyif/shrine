"bundle";System.register("common/converters/count-value-converter.js",[],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d;return{setters:[],execute:function(){a("CountValueConverter",d=function(){function a(){c(this,a)}return a.prototype.toView=function(a){return a<0?"<=10 patients":a+" +-10 patients"},a}()),a("CountValueConverter",d)}}}),System.register("common/converters/datetime.value.converter.js",["moment"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e;return{setters:[function(a){d=a["default"]}],execute:function(){a("DateTimeValueConverter",e=function(){function a(){c(this,a)}return a.prototype.toView=function(a){return d(a).format("MM/DD/YYYY h:mm:ss a")},a}()),a("DateTimeValueConverter",e)}}}),System.register("common/subscriber.js",[],function(a,b){"use strict";return{setters:[],execute:function(){}}}),System.register("main.js",[],function(a,b){"use strict";function c(a){a.use.standardConfiguration().developmentLogging(),a.start().then(function(){return a.setRoot("shell")})}return a("configure",c),{setters:[],execute:function(){}}}),function(){var a=System.amdDefine;a("shell.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><!--compose view-model="views/mailto/mailto" show.bind="view === \'mailto\'">\n\t</compose>\n\t<compose view-model="views/query-viewer/query-viewer" show.bind="view === \'query-viewer-1.24.4\'">\n\t</compose--><compose view-model="views/query-status/query-status"></compose></template>'})}(),System.register("common/i2b2.service.js",["ramda","./container"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g,h;return{setters:[function(a){d=a},function(a){e=a.Container}],execute:function(){a("I2B2Service",(g=f=function b(a){c(this,b);var f=a?e.of(a):e.of(null),g=d.curry(function(a,b){return b.value?e.of(d.prop(a,b.value)):e.of(null)}),h=d.compose(g("i2b2"),g("window"),g("parent")),i=d.compose(g("CRC"),h),j=d.compose(g("events"),h),k=d.compose(g("SHRINE"),h);b.prototype.onResize=function(a){return j(f).map(function(b){return b.changedZoomWindows.subscribe(a)})},b.prototype.onHistory=function(a){return i(f).map(function(b){return b.ctrlr.history.events.onDataUpdate.subscribe(a)})},b.prototype.onQuery=function(a){return j(f).map(function(b){return b.afterQueryInit.subscribe(a)})},b.prototype.onNetworkId=function(a){return j(f).map(function(b){return b.networkIdReceived.subscribe(a)})},b.prototype.onViewSelected=function(a){return g("addEventListener",f).value?e.of(f.value.addEventListener("message",a,!1)):e.of(null)},b.prototype.loadHistory=function(){return i(f).map(function(a){return a.view.history.doRefreshAll()})},b.prototype.loadQuery=function(a){return i(f).map(function(b){return b.ctrlr.QT.doQueryLoad(a)})},b.prototype.errorDetail=function(a){return k(f).map(function(b){return b.plugin.errorDetail(a)})},b.prototype.renameQuery=function(a){return i(f).map(function(b){return b.ctrlr.history.queryRename(a,!1)})},b.prototype.flagQuery=function(a){return i(f).map(function(b){return b.ctrlr.history.Flag({queryId:a,message:""})})},b.prototype.unflagQuery=function(a){return i(f).map(function(b){return b.ctrlr.history.Unflag({queryId:a})})}},f.inject=[window],h=g)),a("I2B2Service",h)}}}),System.register("common/i2b2.pub-sub.js",["aurelia-event-aggregator","./i2b2.service","./shrine.messages"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g,h,i,j;return{setters:[function(a){d=a.EventAggregator},function(a){e=a.I2B2Service},function(a){f=a.notifications,g=a.commands}],execute:function(){a("I2B2PubSub",(i=h=function b(a,d,e,f){c(this,b),this.listen=function(){d.onResize(function(a,b){return b.find(function(a){return"ADD"===a.action})?g():h()}),d.onHistory(function(){return i()}),d.onQuery(function(a,b){return j(b[0].name)}),d.onNetworkId(function(a,b){return l(b[0].networkId)}),d.onViewSelected(function(a){return k(a.data)}),a.subscribe(f.i2b2.cloneQuery,m),a.subscribe(f.i2b2.showError,n),a.subscribe(f.i2b2.renameQuery,o),a.subscribe(f.i2b2.flagQuery,p),a.subscribe(f.i2b2.unflagQuery,q)};var g=function(){return a.publish(e.i2b2.tabMax)},h=function(){return a.publish(e.i2b2.tabMin)},i=function(){return a.publish(e.i2b2.historyRefreshed)},j=function(b){return a.publish(e.i2b2.queryStarted,b)},k=function(b){return a.publish(e.i2b2.viewSelected,b)},l=function(b){return a.publish(e.i2b2.networkIdReceived,b)},m=function(a){return d.loadQuery(a)},n=function(a){console.log(f.i2b2.showError+":  "+a),d.errorDetail(a)},o=function(a){return d.renameQuery(a)},p=function(a){return d.flagQuery(a)},q=function(a){return d.unflagQuery(a)}},h.inject=[d,e,f,g],j=i)),a("I2B2PubSub",j)}}}),System.register("shell.js",["common/i2b2.pub-sub"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g;return{setters:[function(a){d=a.I2B2PubSub}],execute:function(){a("Shell",(f=e=function b(a){c(this,b),a.listen()},e.inject=[d],g=f)),a("Shell",g)}}}),function(){var a=System.amdDefine;a("views/mailto/mailto.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><div class="mailto"><div class="content"><p>If you have questions about your query results or this SHRINE network, contact the Data Steward at your site.</p><div class="email js-email"><button class="button button--large js-button" click.delegate="openEmail()">Email Data Steward</button></div></div></div></template>'})}(),System.register("views/mailto/mailto.service.js",["repository/qep.repository"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g;return{setters:[function(a){d=a.QEPRepository}],execute:function(){a("MailToService",(f=e=function(){function a(b){c(this,a),this.repository=b}return a.prototype.fetchStewardEmail=function(){return this.repository.fetchStewardEmail()},a}(),e.inject=[d],g=f)),a("MailToService",g)}}}),System.register("views/mailto/mailto.config.js",[],function(a,b){"use strict";var c;return{setters:[],execute:function(){a("MailConfig",c={mailto:"mailto:",subject:encodeURIComponent("Question from a SHRINE User"),body:encodeURIComponent("Please enter the suggested information and your question. Your data steward will reply to this email.\n        \n\n***Never send patient information, passwords, or other sensitive information by email****\n        \nName:\n        \nTitle:\n        \nUser name (to log into SHRINE):\n        \nTelephone Number (optional):\n        \nPreferred email address (optional):\n        \n\nQuestion or Comment:")}),a("MailConfig",c)}}}),System.register("views/mailto/mailto.js",["views/mailto/mailto.service","views/mailto/mailto.config"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g,h;return{setters:[function(a){d=a.MailToService},function(a){e=a.MailConfig}],execute:function(){a("MailTo",(g=f=function(){function a(b,d){c(this,a),this.service=b,this.config=d}return a.prototype.openEmail=function(){var a=this;this.service.fetchStewardEmail().then(function(b){window.top.location="mailto:"+b+"?subject="+a.config.subject+"&body="+a.config.body})},a}(),f.inject=[d,e],h=g)),a("MailTo",h)}}}),function(){var a=System.amdDefine;a("views/query-status/node-result/node-result.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><require from="./result-types/error/error"></require><require from="./result-types/patient-count/patient-count"></require><div style="clear:both"><br><div style="float:left; font-weight:bold; margin-left:20px">${result.adapterNode} ${queryName}</div></div><patient-count if.one-way="result.statusMessage === \'COMPLETED\' || result.statusMessage === \'FINISHED\'" result.one-way="result"></patient-count><error if.one-way="result.statusMessage === \'ERROR\'" result.one-way="result"></error><span if.one-way="[\'ERROR\',\'COMPLETED\',\'FINISHED\'].indexOf(result.statusMessage) === -1">&nbsp;- <span style="color: #00dd00">${result.statusMessage}</span></span></template>'})}(),System.register("views/query-status/node-result/node-result.js",["aurelia-framework"],function(a,b){"use strict";function c(a,b,c,d){c&&Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(d):void 0})}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}var f,g,h,i,j,k,l,m;return{setters:[function(a){f=a.customElement,g=a.bindable}],execute:function(){a("NodeResult",(h=f("node-result"),m=h((j=function b(){d(this,b),c(this,"result",k,this),c(this,"queryName",l,this)},k=e(j.prototype,"result",[g],{enumerable:!0,initializer:null}),l=e(j.prototype,"queryName",[g],{enumerable:!0,initializer:null}),i=j))||i)),a("NodeResult",m)}}}),function(){var a=System.amdDefine;a("views/query-status/node-result/result-types/error/error.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template>&nbsp;- <span title="${result.statusDescription}"><b><a class="query-error-anchor" href="#" style="color:#ff0000" click.delegate="publish(commands.i2b2.showError, result)"><b><span color="#ff0000">ERROR: ${result.statusDescription}</span></b></a></b></span></template>'})}(),System.register("views/query-status/node-result/result-types/error/error.js",["aurelia-framework","common/publisher"],function(a,b){"use strict";function c(a,b,c,d){c&&Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(d):void 0})}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}var h,i,j,k,l,m,n,o,p;return{setters:[function(a){h=a.inject,i=a.bindable,j=a.customElement},function(a){k=a.Publisher}],execute:function(){a("Error",(l=j("error"),p=l((n=function(a){function b(){d(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];var i=e(this,a.call.apply(a,[this].concat(g)));return c(i,"result",o,i),i}return f(b,a),b}(k),o=g(n.prototype,"result",[i],{enumerable:!0,initializer:null}),m=n))||m)),a("Error",p)}}}),function(){var a=System.amdDefine;a("views/query-status/node-result/result-types/patient-count/breakdown.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><div style="clear: both; margin-left: 30px; float: left; height: 16px; line-height: 16px"><br><font>Patient Age Count Breakdown:</font><!-- ${breakdown.name} --></div><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px"></div><!-- repeat.for result in breakdown.results \n        <div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px;"> \n            ${result.name}: <font color="#0000dd"> ${result.detail}</font>\n        </div>    \n        --><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px">0-9 years old: <font color="#0000dd">- 10 patients or fewer</font></div><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px">10-17 years old: <font color="#0000dd">- 10 patients or fewer</font></div><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px">18-34 years old: <font color="#0000dd">- 355 +-10 patients</font></div><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px">35-44 years old: <font color="#0000dd">- 200 +-10 patients</font></div><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px">45-54 years old: <font color="#0000dd">- 95 +-10 patients</font></div><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px">55-64 years old: <font color="#0000dd">- 15 +-10 patients</font></div><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px">65-74 years old: <font color="#0000dd">- 65 +-10 patients</font></div><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px">75-84 years old: <font color="#0000dd">- 60 +-10 patients</font></div><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px">&gt;= 65 years old: <font color="#0000dd">- 170 +-10 patients</font></div><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px">&gt;= 85 years old: <font color="#0000dd">- 55 +-10 patients</font></div><div style="clear: both; margin-left: 40px; float: left; height: 16px; line-height: 16px">Not recorded: <font color="#0000dd">- 10 patients or fewer</font></div></template>'})}(),function(){var a=System.amdDefine;a("views/query-status/node-result/result-types/patient-count/patient-count.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><require from="common/converters/count-value-converter"></require><div style="clear: both; margin-left: 30px; float: left; height: 16px; line-height: 16px">Patient Count: <font color="#0000dd">- ${result.count | count}</font></div><!--\n        <breakdown if.one-way="showBreakdown" repeat.for="breakdown in breakdowns"></breakdown>\n    --></template>'})}(),System.register("views/query-status/node-result/result-types/patient-count/patient-count.js",["aurelia-framework"],function(a,b){"use strict";function c(a,b,c,d){c&&Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(d):void 0})}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}var f,g,h,i,j,k,l,m;return{setters:[function(a){f=a.bindable,g=a.customElement}],execute:function(){a("PatientCount",(h=g("patient-count"),m=h((j=function b(){d(this,b),c(this,"result",k,this),c(this,"showBreakdown",l,this)},k=e(j.prototype,"result",[f],{enumerable:!0,initializer:null}),l=e(j.prototype,"showBreakdown",[f],{enumerable:!0,initializer:null}),i=j))||i)),a("PatientCount",m)}}}),function(){var a=System.amdDefine;a("views/query-status/node-status/node-status.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><require from="common/converters/count-value-converter"></require><div style="display: flex"><div style="flex:1">${result.adapterNode}</div><div style="flex:1"><span if.one-way="result.statusMessage === \'COMPLETED\' || result.statusMessage === \'FINISHED\'" style="display: inline-block; color: #0000dd">&nbsp;- ${result.count | count} </span><span>&nbsp;- <a if.one-way="result.statusMessage === \'ERROR\'" class="query-error-anchor" href="#" style="color:#ff0000" click.delegate="publish(commands.i2b2.showError, result)">ERROR: ${result.statusDescription} </a></span><span if.one-way="[\'ERROR\',\'COMPLETED\',\'FINISHED\'].indexOf(result.statusMessage) === -1">&nbsp;- <span style="color: #00dd00">${result.statusMessage}</span></span></div></div></template>'})}(),System.register("common/publisher.js",["aurelia-event-aggregator","common/shrine.messages"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g,h;return{setters:[function(a){d=a.EventAggregator},function(a){e=a.commands}],execute:function(){a("Publisher",(g=f=function b(a,d){c(this,b),this.commands=d,this.publish=function(b,c){return a.publish(b,c)}},f.inject=[d,e],h=g)),a("Publisher",h)}}}),System.register("views/query-status/node-status/node-status.js",["aurelia-framework","common/publisher"],function(a,b){"use strict";function c(a,b,c,d){c&&Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(d):void 0})}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}var h,i,j,k,l,m,n,o;return{setters:[function(a){h=a.customElement,i=a.bindable},function(a){j=a.Publisher}],execute:function(){a("NodeStatus",(k=h("node-status"),o=k((m=function(a){function b(){d(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];var i=e(this,a.call.apply(a,[this].concat(g)));return c(i,"result",n,i),i}return f(b,a),b}(j),n=g(m.prototype,"result",[i],{enumerable:!0,initializer:null}),l=m))||l)),a("NodeStatus",o)}}}),function(){var a=System.amdDefine;a("views/query-status/query-status.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><require from="./node-result/node-result"></require><require from="common/converters/datetime.value.converter"></require><require from="./node-status/node-status"></require><div style="height: 100%; overflow: auto"><div style="display: flex"><div style="flex:1">Status of Query: ${status.query.queryName}</div><div style="flex:1">Last Updated: ${status.updated | dateTime}</div></div><br><node-status repeat.for="node of status.nodes" result.one-way="node"></node-status><span if.one-way="status.nodes"><br><div>Query results are shown below</div><span>**************************************************************************</span><br></span><node-result repeat.for="node of status.nodes" result.one-way="node" query-name.one-way="status.query.queryName"></node-result></div></template>'})}(),System.register("common/query-status.model.js",["aurelia-event-aggregator","repository/qep.repository","./shrine.messages"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g,h,i,j,k;return{setters:[function(a){d=a.EventAggregator},function(a){e=a.QEPRepository},function(a){f=a.commands,g=a.notifications}],execute:function(){h=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},a("QueryStatusModel",(j=i=function b(a,d,e){c(this,b);var g=function(b){return a.publish(e.shrine.queryReceived,b)},i=function(a){return console.log("ERROR: "+a)},j=function(a){return new Promise(function(b,c){var d=[].concat(a.queryResults[0].adaptersToResults),e=d.reduce(function(a,b){return["FINISHED","ERROR"].indexOf(b.status)!=-1?a+1:a},0),f=h({},a.queryResults[0].query,{complete:d.length===e});b({query:f,nodes:d,finishedCount:e})})},k=function(a){return d.fetchQuery(a).then(function(a){return j(a)})["catch"](function(a){return i(a)}).then(function(a){return g(a)})},l=function(){a.subscribe(f.shrine.fetchQuery,function(a){return k(a)})};l()},i.inject=[d,e,g],k=j)),a("QueryStatusModel",k)}}}),System.register("views/query-status/query-status.js",["aurelia-event-aggregator","common/shrine.messages","common/query-status.model"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g,h,i,j,k;return{setters:[function(a){d=a.EventAggregator},function(a){e=a.notifications,f=a.commands},function(a){g=a.QueryStatusModel}],execute:function(){h=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},a("QueryStatus",(j=i=function b(a,d,e,f){var g=this;c(this,b);var i=function(){return{query:{queryName:null,updated:null,complete:!1},nodes:null}};this.status=i();var j=function(b){return a.publish(e.shrine.fetchQuery,b)};a.subscribe(d.i2b2.networkIdReceived,function(a){return j(a)}),a.subscribe(d.shrine.queryReceived,function(a){g.status.query=h({},g.status.query,a.query),g.status.nodes=a.nodes,g.status.updated=Number(new Date);var b=a.query.complete,c=a.query.networkId;b||j(c)})},i.inject=[d,e,f,g],k=j)),a("QueryStatus",k)}}}),System.register("views/query-viewer/box-style.converter.js",[],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d;return{setters:[],execute:function(){a("BoxStyleValueConverter",d=function(){function a(){c(this,a)}return a.prototype.toView=function(a){return"transform: translate("+String(-100*a)+"%);"},a}()),a("BoxStyleValueConverter",d)}}}),function(){var a=System.amdDefine;a("views/query-viewer/context-menu/context-menu.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><ul class="context-menu ${context.class || \'hide\'}" mouseleave.trigger="context.class=\'hide\'" css="top: ${context.y - 40}; left: ${context.x - 50};"><li if.bind="context.isCount"><a click.delegate="refreshHistory()" href="#"><i class="fa fa-bar-chart-o"></i>Breakdown</a></li><li click.delegate="cloneQuery(context.query.id)"><a href="#"><i class="fa fa-files-o"></i> Clone</a></li><li><a click.delegate="renameQuery(context.query.id)" href="#"><i class="fa fa-edit"></i> Rename</a></li><!--li><a click.delegate="flagQuery(context.query.id)" href="#"><i class="fa fa-flag"></i> Flag</a></li--><!--li><a click.delegate="unflagQuery(context.query.id)" href="#"><i class="fa fa-flag-o"></i> Unflag</a></li--></ul></template>'})}(),System.register("views/query-viewer/context-menu/context-menu.js",["aurelia-framework","aurelia-event-aggregator","common/shrine.messages"],function(a,b){"use strict";function c(a,b,c,d){c&&Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(d):void 0})}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}var f,g,h,i,j,k,l,m,n;return{setters:[function(a){f=a.bindable},function(a){g=a.EventAggregator},function(a){h=a.commands}],execute:function(){a("ContextMenu",(l=k=function b(a,c){var e=this;d(this,b),m.call(this),b.prototype.cloneQuery=function(b){a.publish(c.i2b2.cloneQuery,b),e.context["class"]="hide"},b.prototype.renameQuery=function(b){a.publish(c.i2b2.renameQuery,b),e.context["class"]="hide"},b.prototype.flagQuery=function(b){a.publish(c.i2b2.flagQuery,b),e.context["class"]="hide"},b.prototype.unflagQuery=function(b){a.publish(c.i2b2.unflagQuery,b),e.context["class"]="hide"}},k.inject=[g,h],m=function(){c(this,"context",j,this)},i=l,j=e(i.prototype,"context",[f],{enumerable:!0,initializer:null}),n=i)),a("ContextMenu",n)}}}),System.register("views/query-viewer/date.converter.js",["moment"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e;return{setters:[function(a){d=a["default"]}],execute:function(){a("DateValueConverter",e=function(){function a(){c(this,a)}return a.prototype.toView=function(a){return d(a).format("MM/DD/YYYY")},a}()),a("DateValueConverter",e)}}}),function(){var a=System.amdDefine;a("views/query-viewer/loading-bar/loading-bar.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><div class="loader"><h1>${status}</h1><div class="slider"><div class="line"></div><div class="break dot1"></div><div class="break dot2"></div><div class="break dot3"></div></div></div></template>'})}(),System.register("views/query-viewer/loading-bar/loading-bar.js",["aurelia-framework"],function(a,b){"use strict";function c(a,b,c,d){c&&Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(d):void 0})}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}var f,g,h,i;return{setters:[function(a){f=a.bindable}],execute:function(){a("LoadingBar",(g=function b(){d(this,b),c(this,"status",h,this)},h=e(g.prototype,"status",[f],{enumerable:!0,initializer:null}),i=g)),a("LoadingBar",i)}}}),function(){var a=System.amdDefine;a("views/query-viewer/loading-bar/row-loader.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return""})}(),function(){var a=System.amdDefine;a("views/query-viewer/paginator/paginator.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet" type="text/css"><div class="paginator"><ol class="btn-group"><li class="btn-group__item" click.delegate="pageIndex = index - 1"><i class="i-chevron-left"></i></li><li repeat.for="page of pages" class="btn-group__item" click.delegate="pageIndex = $index"><button class="btn btn--basic ${index === $index? \'current\' : \'\'}">${$index + 1}</button></li><li class="btn-group__item" click.delegate="pageIndex = index + 1"><i class="i-chevron-right"></i></li></ol></div></template>'})}(),System.register("views/query-viewer/paginator/paginator.js",["aurelia-framework"],function(a,b){"use strict";function c(a,b,c,d){c&&Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(d):void 0})}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}var f,g,h,i,j,k,l;return{setters:[function(a){f=a.bindable}],execute:function(){g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),a("Paginator",(k=j=function(){function a(b){var e=this;d(this,a),c(this,"pages",i,this),a.prototype.init=function(){e.index=0,e.element=b},this.init()}return g(a,[{key:"pageIndex",set:function(a){var b=this.pages.length-1;this.index=a<0?0:a>b?b:a,this.element.dispatchEvent(new CustomEvent("paginator-click",{detail:{index:this.index},bubbles:!0,cancelable:!0}))}}]),a}(),j.inject=[Element],h=k,i=e(h.prototype,"pages",[f],{enumerable:!0,initializer:null}),l=h)),a("Paginator",l)}}}),function(){var a=System.amdDefine;a("views/query-viewer/query-status/query-status.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><div class="tooltip"><span ref="tooltipContent" data-line1="Total: ${total}" data-line2="Available: ${finished}, Error: ${error}, Pending: ${pending}"><svg viewbox="0 0 35 35" class="query-status"><circle cx="18" cy="16" r="12" class="countdown__background"/><circle cx="18" cy="16" r="12" class="error__progress" css="stroke-dashoffset: ${errorOffset}"/><circle cx="18" cy="16" r="12" class="ready__progress" css="stroke-dashoffset: ${readyOffset}"/></svg></span></div></template>'})}(),System.register("views/query-viewer/query-status/query-status.js",["aurelia-framework","ramda"],function(a,b){"use strict";function c(a,b,c,d){c&&Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(d):void 0})}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}var f,g,h,i,j,k,l,m;return{setters:[function(a){f=a.bindable},function(a){g=a}],execute:function(){a("QueryStatus",(k=j=function(){function a(b){d(this,a),l.call(this),this.floor=b.floor}return a.prototype.attached=function(){var a=75,b=g.curry(function(a,b,c,d){return a(d/c*b)})(this.floor,a,this.status.total),c=this.status,d=b(c.finished),e=b(c.error);this.readyOffset=100-d,this.errorOffset=this.readyOffset-e,this.finished=c.finished,this.error=c.error,this.pending=c.total-(c.finished+c.error),this.total=c.total},a}(),j.inject=[Math],l=function(){c(this,"status",i,this)},h=k,i=e(h.prototype,"status",[f],{enumerable:!0,initializer:null}),m=h)),a("QueryStatus",m)}}}),System.register("views/query-viewer/query-viewer.config.js",[],function(a,b){"use strict";var c;return{setters:[],execute:function(){a("QueryViewerConfig",c={maxNodesPerScreen:10,
maxQueriesPerScroll:40}),a("QueryViewerConfig",c)}}}),function(){var a=System.amdDefine;a("views/query-viewer/query-viewer.html!github:systemjs/plugin-text@0.0.8.js",[],function(){return'<template><require from="views/query-viewer/result-style.converter"></require><require from="views/query-viewer/result-value.converter"></require><require from="views/query-viewer/box-style.converter"></require><require from="views/query-viewer/context-menu/context-menu"></require><require from="views/query-viewer/loading-bar/loading-bar"></require><require from="views/query-viewer/paginator/paginator"></require><require from="views/query-viewer/date.converter"></require><require from="views/query-viewer/query-status/query-status"></require><span class="query-viewer"><loading-bar status.bind="\'Loading...\'" if.bind="showLoader"></loading-bar><div style="width: 100%; text-align: center"><paginator pages.bind="pages" paginator-click.delegate="updatePage($event)" if.bind="pages.length > 1"></paginator></div><div class="flex-table"><div class="flex-table-row node-header"><div class="flex-table-item"></div><div class="flex-table-item"></div><div class="flex-table-item"></div><div class="flex-table-item"></div><div repeat.for="node of page.nodes" class="flex-table-item">${node}</div></div></div><div class="flex-table query-viewer ${vertStyle}" scroll.trigger="onScroll($event)"><div><!-- @todo: create running query component --><div class="flex-table-row" if.bind="runningQueryName"><div class="flex-table-item"></div><div class="flex-table-item">${runningQueryName}</div><div class="flex-table-item"></div><div class="flex-table-item"></div><div class="flex-table-item" repeat.for="node of page.nodes" style="color: #00FF00">RUNNING</div></div><div repeat.for="result of page.results" class="flex-table-row"><div class="flex-table-item"><i if.bind="result.flagged" class="fa fa-flag"></i> <i if.bind="!result.flagged" class="fa fa-flag-o"></i></div><div class="flex-table-item" click.delegate="context = getContext($event, result)"><div class="ellipses">${result.name}</div></div><div class="flex-table-item" click.delegate="context = getContext($event, result)">${result.date | date}</div><div class="flex-table-item"><query-status status.bind="result.status"></query-status></div><div repeat.for="nodeResult of result.nodeResults" class="flex-table-item" click.delegate="context = getContext($event, result)"><a if.bind="nodeResult.status === \'ERROR\'" style="text-decoration: underline; color:red" click.delegate="publishError($event, nodeResult)">${nodeResult.status} </a>${nodeResult}</div></div><div class="flex-table-row" if.bind="loadingInfiniteScroll"><div style="width: 100%; text-align: center; font-size: 1.5rem; background:rgba(217, 236, 240, .05); text-align:center; color: rgba(0, 0, 0, .20)"><i class="fa fa-spinner fa-spin" style="color: inherit"></i> Loading...</div></div></div></div><!-- context menu --><context-menu context.bind="context"></context-menu></span></template>'})}(),System.register("repository/qep.repository.js",["aurelia-fetch-client","fetch"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g,h;return{setters:[function(a){d=a.HttpClient},function(a){}],execute:function(){e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),a("QEPRepository",(g=f=function(){function a(b){var d=this;c(this,a),b.configure(function(a){a.useStandardConfiguration().withBaseUrl(d.url).withDefaults({headers:{Authorization:"Basic "+d.auth}})}),this.http=b}return a.prototype.fetchPreviousQueries=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.http.fetch("qep/queryResults?limit="+a+"&skip="+b).then(function(a){return a.json()})["catch"](function(a){return a})},a.prototype.fetchNetworkId=function(a){return this.http.fetch("qep/networkId?queryName='"+a+"'").then(function(a){return a.json()})["catch"](function(a){return a})},a.prototype.fetchQuery=function(a){return this.http.fetch("qep/queryResults?networkId="+a).then(function(a){return a.json()})["catch"](function(a){return a})},a.prototype.fetchStewardEmail=function(){return this.http.fetch("data?key=stewardEmail").then(function(a){return a.json()}).then(function(a){return a.indexOf('"')>0?a.split('"')[1]:a})["catch"](function(){return""})},e(a,[{key:"url",get:function(){var a=document.URL,b=":6443/shrine-metadata/";return a.substring(0,a.lastIndexOf(":"))+b}},{key:"auth",get:function(){var a=sessionStorage.getItem("shrine.auth");return sessionStorage.removeItem("shrine.auth"),a}}]),a}(),f.inject=[d],h=g)),a("QEPRepository",h)}}}),System.register("common/queries.model.js",["aurelia-event-aggregator","repository/qep.repository","./shrine.messages"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g,h,i;return{setters:[function(a){d=a.EventAggregator},function(a){e=a.QEPRepository},function(a){f=a.notifications}],execute:function(){a("QueriesModel",(h=g=function b(a,d,e){var f=this;c(this,b);var g=d,h=40,i=0,j=0,k=null;b.prototype.load=function(){return g.fetchPreviousQueries(f.maxQueriesPerFetch()+f.loadedCount()).then(function(a){return j=a.rowCount,i=a.queryResults.length,a})["catch"](function(a){return console.log(a)}).then(l).then(function(b){k=b,a.publish(e.shrine.queriesReceived,k)})},b.prototype.totalQueries=function(){return j},b.prototype.loadedCount=function(){return i},b.prototype.maxQueriesPerFetch=function(){return h},b.prototype.moreToLoad=function(){return i<j},b.prototype.hasData=function(){return null!==k&&void 0!==k};var l=function(a){arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return new Promise(function(b,c){for(var d=[],e=6,f=a.adapters,g=f.length,h=a.queryResults,i=0;i<g;i+=e){var j=m(f,i,e),k=f.slice(i,j),l=n(k,h);d.push({nodes:k,results:l})}b(d)})},m=function(a,b,c){var d=b+c;return d<a.length?d:a.length},n=function(a,b){var c=[];return b.forEach(function(b,d){var e={name:b.query.queryName,id:b.query.networkId,date:b.query.dateCreated,flagged:b.query.flagged===!0,flagMessage:b.query.flagMessage||null,nodeResults:[],status:b.adaptersToResults.reduce(function(a,c){var d="FINISHED"===c.status?a.finished+1:a.finished,e="ERROR"===c.status?a.error+1:a.error;return{error:e,finished:d,total:b.adaptersToResults.length}},{error:0,finished:0,total:b.adaptersToResults.length})};a.forEach(function(a){e.nodeResults.push(b.adaptersToResults.find(function(b){return b.adapterNode===a}))}),c.push(e)}),c}},g.inject=[d,e,f],i=h)),a("QueriesModel",i)}}}),System.register("common/container.js",["ramda"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f;return{setters:[function(a){d=a}],execute:function(){e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),a("Container",f=function(){function a(b){c(this,a),this.__value=b}return a.of=function(b){return new a(function(){return b})},a.prototype.map=function(b){return this.hasNothing()?a.of(null):a.of(b(this.value))},a.prototype.join=function(){return this.hasNothing()?a.of(null):this.value},a.prototype.chain=function(a){return this.map(a).join()},a.prototype.hasNothing=function(){return null===this.value||void 0===this.value},a.prototype.ap=function(a){a.map(this.value)},e(a,[{key:"value",get:function(){return this.__value()}}]),a}()),a("Container",f)}}}),System.register("views/query-viewer/scroll.service.js",["ramda","common/container"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g,h;return{setters:[function(a){d=a},function(a){e=a.Container}],execute:function(){a("ScrollService",(g=f=function b(){c(this,b)},f.either=d.curry(function(a,b,c){return e.of(d.prop(a,c)||b)}),f.target=function(a,b){return h.either("target",b,b).chain(function(b){return h.either(a,0,b)})},f.clientHeight=function(a){return h.target("clientHeight",a)},f.scrollHeight=function(a){return h.target("scrollHeight",a)},f.scrollTop=function(a){return h.target("scrollTop",a)},f.userScroll=function(a){return h.clientHeight(a).map(function(b){return b+h.scrollTop(a).value})},f.scrollRatio=function(a){return h.userScroll(a).map(function(b){return b/h.scrollHeight(a).value})},h=g)),a("ScrollService",h)}}}),System.register("common/shrine.messages.js",[],function(a,b){"use strict";var c,d;return{setters:[],execute:function(){a("notifications",c={i2b2:{tabMax:"notification.from.i2b2.tab.max",tabMin:"notification.from.i2b2.tab.min",viewSelected:"notification.from.i2b2.tab.selected",historyRefreshed:"notification.from.i2b2.history.refreshed",queryStarted:"notification.from.i2b2.query.started",messageReceived:"notification.from.i2b2.message.received",networkIdReceived:"notification.from.i2b2.networkId.receieved"},shrine:{queriesReceived:"notification.from.shrine.queries.received",queryReceived:"notification.from.shrine.query.recieved"}}),a("notifications",c),a("commands",d={i2b2:{cloneQuery:"command.to.i2b2.clone.query",showError:"command.to.i2b2.show.error",flagQuery:"command.to.i2b2.flag.query",unflagQuery:"command.to.i2b2.unflag.query",renameQuery:"command.to.i2b2.rename.query"},shrine:{fetchQuery:"command.to.shrine.fetch.query"}}),a("commands",d)}}}),System.register("views/query-viewer/query-viewer.js",["aurelia-event-aggregator","common/queries.model","./scroll.service","common/shrine.messages"],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d,e,f,g,h,i,j,k;return{setters:[function(a){d=a.EventAggregator},function(a){e=a.QueriesModel},function(a){f=a.ScrollService},function(a){g=a.notifications,h=a.commands}],execute:function(){a("QueryViewer",(j=i=function(){function a(b,d,e,g){var h=this;c(this,a),a.prototype.init=function(){h.pageIndex=0,h.showLoader=!0,h.vertStyle="v-min",h.runningQueryName=null},this.init(),a.prototype.setToPage=function(a){h.pageIndex=a,h.page=h.pages[h.pageIndex]};var i=function(a){return 1===f.scrollRatio(a).value};a.prototype.onScroll=function(a){i(a)&&!h.loadingInfiniteScroll&&d.moreToLoad()&&(h.loadingInfiniteScroll=!0,d.load())},a.prototype.publishError=function(a,c){return a.stopPropagation(),b.publish(g.i2b2.showError,c)},a.prototype.getContext=function(a,b,c){return{x:a.pageX,y:a.pageY,"class":"show",query:b,isCount:void 0!==c,count:c}},b.subscribe(e.i2b2.historyRefreshed,function(){return d.load()}),b.subscribe(e.i2b2.tabMax,function(){return h.vertStyle="v-full"}),b.subscribe(e.i2b2.tabMin,function(){return h.vertStyle="v-min"}),b.subscribe(e.i2b2.queryStarted,function(a){return h.runningQueryName=a}),b.subscribe(e.shrine.queriesReceived,function(a){h.pages=a,h.page=h.pages[0],h.runningQueryName=null,h.loadingInfiniteScroll=!1,h.showLoader=!1})}return a.prototype.updatePage=function(a){a.stopPropagation();var b=event.detail.index;this.page=this.pages[b]},a}(),i.inject=[d,e,g,h],k=j)),a("QueryViewer",k)}}}),System.register("views/query-viewer/result-style.converter.js",[],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d;return{setters:[],execute:function(){a("ResultStyleValueConverter",d=function(){function a(){c(this,a)}return a.prototype.toView=function(a){var b=this.isUnresolved(a)?"color:"+this.getColorValue(a):"";return b},a.prototype.isUnresolved=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FINISHED";return!a||a.status!==b},a.prototype.getColorValue=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ERROR",c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#FF0000",d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#00FF00";return a&&a.status!==b?d:c},a}()),a("ResultStyleValueConverter",d)}}}),System.register("views/query-viewer/result-value.converter.js",[],function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d;return{setters:[],execute:function(){a("ResultValueConverter",d=function(){function a(){c(this,a)}return a.prototype.toView=function(a){return a?"FINISHED"!==a.status?"":a.count<0?"<=10":a.count:"not available"},a}()),a("ResultValueConverter",d)}}});